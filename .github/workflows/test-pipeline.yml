name: build-and-deploy-test-stable
on:
  push:
    branches:
      - 'master'
      - 'hotfix**'
  workflow_dispatch:
    inputs:
      boolean_input:
        description: 'A boolean input'
        required: true
        type: boolean
        default: false
jobs:
  echoing-job-for-test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Echo inputs 
        run: echo "${{ inputs.boolean_input }}"
  failing-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Fail
        run: cat non-existing-file
  some-other-not-dependent-job:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Echo something 
        run: echo "Something"
  dependent-job:
    runs-on: ubuntu-latest
    needs: failing-job
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      - name: Echo something
        run: echo "Something"
  status-checking-job:
    runs-on: ubuntu-latest
    needs: [echoing-job-for-test, dependent-job, some-other-not-dependent-job]
    if: always()
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
      # https://github.com/marketplace/actions/workflow-conclusion-action
      - name: Use community step
        uses: technote-space/workflow-conclusion-action@v3
      - name: Echo failure for entire workflow status
        run: echo "FAILURE"
        if: env.WORKFLOW_CONCLUSION == 'failure'
      - name: Echo success for entire workflow status
        run: echo "SUCCESS"
        if: env.WORKFLOW_CONCLUSION == 'success'